create keyspace etm with replication = { 'class' : 'SimpleStrategy', 'replication_factor' : 1 };

create table telemetry_event ( 
    id timeuuid primary key, 
    application text,
    correlationTimeDifference bigint, 
    content text, 
    correlationId timeuuid, 
    endpoint text, 
    eventName text,
    eventTime timestamp, 
    sourceId text, 
    sourceCorrelationId text, 
    transactionId timeuuid, 
    transactionName text,
    type text
);

create table sourceid_id_correlation (
    sourceId text primary key,
    id timeuuid,
    transactionId timeuuid,
    transactionName text,
    eventTime timestamp
);

create table application_counter (
    application text,
    timeunit timestamp,
    count counter,
    messageRequestCount counter,
    messageResponseCount counter,
    messageDatagramCount counter,
    messageResponseTime counter,
    primary key (application, timeunit)
);

create table eventname_counter (
    eventName text,
    timeunit timestamp,
    count counter,
    messageRequestCount counter,
    messageResponseCount counter,
    messageDatagramCount counter,
    messageResponseTime counter,
    primary key (eventName, timeunit)
);

create table application_event_counter (
    application text,
    eventName text,
    timeunit timestamp,
    count counter,
    messageRequestCount counter,
    messageResponseCount counter,
    messageDatagramCount counter,
    messageResponseTime counter,
    primary key (application, eventName, timeunit)
);

create table transactionname_counter (
    transactionName text,
    timeunit timestamp,
    count counter,
    primary key (transactionName, timeunit)
);

create table endpoint_config (
    endpoint text primary key,
    applicationParsers list<text>,
    eventNameParsers list<text>,
    correlationParsers map<text, text>
);

create table correlation_data (
    id timeuuid,
    name text,
    value text,
    transactionId timeuuid, 
    transactionName text,
    primary key (id, name, value)
);

insert into endpoint_config(endpoint, applicationParsers, eventNameParsers, correlationParsers) values ('KCS.REQ.ESB', ['KCS'], ['xpath:local-name(/*)'], {'CustomerId':'xpath:/*/relatienummer'});